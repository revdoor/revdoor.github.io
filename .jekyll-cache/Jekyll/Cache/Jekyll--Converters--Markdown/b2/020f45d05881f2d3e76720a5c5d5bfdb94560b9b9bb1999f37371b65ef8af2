I"K<h2 id="문제-링크">문제 링크</h2>

<p><a href="https://www.acmicpc.net/problem/1825">https://www.acmicpc.net/problem/1825</a></p>

<h2 id="문제-설명">문제 설명</h2>

<p><a href="/PS/boj-1201">1201번</a>과 거의 같습니다.</p>

<p>$1$~$N$까지의 수를 한번씩 이용해서 최대 부분 증가수열의 길이가 $M$이고, 최대 부분 감소수열의 길이가 $K$인 것을 구하는데, 그러한 수열 중 사전순으로 가장 앞서는 것과 사전순으로 마지막에 오는 것을 구하는 문제입니다.</p>

<h2 id="문제-풀이">문제 풀이</h2>

<p>안 되는 경우는 1201번 풀이에서 확인한 것과 똑같이 확인할 수 있습니다.</p>

<p>문제는 되는 경우에 대해서 사전순으로 가장 앞서는 것과 마지막에 오는 것을 찾아야 한다는 것입니다.
어떻게 수열을 구성해야 될까요?</p>

<p> </p>

<h3 id="사전순으로-가장-앞서는-수열과-마지막-수열-찾기">사전순으로 가장 앞서는 수열과 마지막 수열 찾기</h3>

<p>1201번을 풀 때 사용한 구성적 알고리즘을 응용합니다.</p>

<p>사전순으로 가장 앞서는 것의 경우 $M$개의 감소하는 구간을 만들고, 먼저 나온 구간의 모든 수가 나중에 나온 구간의 모든 수보다 작게 합니다.
이때, 구간의 길이를 정하는 것에 있어서 가능한 한 뒤쪽 구간들의 길이가 더 길게 합니다.</p>

<p>예를 들어서 $N=13, M=5, K=4$인 경우를 생각해 봅시다.</p>

<p>$5$개의 감소하는 구간을 만드는데, 가능한 한 뒤쪽 구간들의 길이가 더 길게 합니다.
그러면, 감소하는 구간의 길이는 순서대로 $1, 1, 3, 4, 4$가 됩니다.</p>

<p>이를 바탕으로 수열을 만들면 $(1), (2), (5, 4, 3), (9, 8, 7, 6), (13, 12, 11, 10)$이 됩니다.</p>

<p> </p>

<p>사전순으로 마지막에 오는 것도 비슷한 알고리즘을 사용합니다.</p>

<p>이번에는 $K$개의 증가하는 구간을 만들고, 먼저 나온 구간의 모든 수가 나중에 나온 구간의 모든 수보다 크게 합니다.
마찬가지로 가능한 한 뒤쪽 구간들의 길이가 더 길게 합니다.</p>

<p>$N=13, M=5, K=4$일 경우 만들어지는 수열은 $(13), (11, 12), (6, 7, 8, 9, 10), (1, 2, 3, 4, 5)$가 됩니다.</p>

<p>이렇게 만든 수열 두개가 각각 사전순으로 가장 앞서는 것과 마지막인지 어떻게 알 수 있을까요?</p>

<p> </p>

<h3 id="알고리즘의-정당성-증명-사전순으로-가장-앞서는가">알고리즘의 정당성 증명: 사전순으로 가장 앞서는가?</h3>

<p>기본적인 접근은 동일하기 때문에 첫 번째 알고리즘으로 찾아낸 수열이 사전순으로 가장 앞서는지만 확인해봅시다.
두 번째 알고리즘으로 찾아낸 수열이 사전순으로 마지막인지 여부도 비슷하게 증명할 수 있습니다.</p>

<p>알고리즘으로 만든 수열을 수열 $S$라고 부릅시다.</p>

<p>수열 $S$에서 길이가 1보다 길고 $K$보다 작은 감소하는 구간은 최대 1개입니다.</p>

<p>또한 감소하는 구간의 길이는 (만일 길이가 1인 구간이 존재한다면) 길이가 1인 구간들이 전부 앞에 몰려있으며, 그 뒤 구간들의 길이는 1보다 큽니다.</p>

<p>그리고 (만일 존재한다면) 길이가 1보다 크고 $K$보다 작은 구간이 나오며, 이후 구간의 길이는 모두 $K$입니다.</p>

<p>이는 알고리즘에서 가능한 한 뒤쪽 구간들의 길이를 길게 했기 때문이며, 실제로 $N=13, M=5, K=4$ 예시에서 구간의 길이는 $1, 1, 3, 4, 4$로 성립하는 것을 확인할 수 있습니다.</p>

<p> </p>

<p>이제 조건을 만족하면서 사전순으로 수열 $S$보다 더 앞서는 수열이 있다고 가정합니다.
그 수열을 수열 $A$라고 부르겠습니다.</p>

<p>수열 $A$와 수열 $S$를 비교하면, 수열 $A$가 사전 순으로 더 앞서기 때문에 더 작은 숫자가 나오는 위치가 존재합니다.</p>

<p>해당 위치는 길이가 1인 구간은 아닙니다.
이는 길이가 1인 구간들이 있다면 수열 $S$에서 해당 부분들은 $1, 2, …$와 같이 1부터 순서대로 커지기 때문입니다.</p>

<p>즉, 길이가 1보다 긴 구간의 특정 위치가 나오게 됩니다.</p>

<p>수열 $A$에서 해당 위치의 값을 $P$, 수열 $S$에서 해당 위치의 값을 $Q$라고 부릅시다.
또한, 수열 $S$에서 이 구간보다 앞에 있는 구간의 개수를 $s$, 뒤에 있는 구간의 개수를 $t$라고 합시다.</p>

<p>이 경우, $s+t+1=M$이 됩니다.
또한, 수열 $S$에서 이 구간보다 뒤에 있는 모든 구간의 길이는 $K$가 됩니다.</p>

<p> </p>

<p>이제 수열 $A$에서 $P$를 포함하는 증가하는 부분수열을 생각합니다.</p>

<p>$P$까지의 길이는 $s+1$이 됩니다.
$P$보다 큰 값은 적어도 $tK+1$개 있습니다. (수열 $S$에서 이 구간보다 뒤에 있는 구간들에 있는 수의 개수가 총 $tK$개, 추가로 $Q$가 $P$보다 뒤에 위치하기 때문)</p>

<p>이들을 어떻게 배치하더라도 증가하는 부분수열에서 $P$보다 뒤에 있는 구간의 길이는 $t+1$ 이상입니다.
이는 Erdős–Szekeres theorem으로 보일 수 있습니다.
$r=t+1$, $s=K+1$을 넣을 경우 길이가 $t+1$인 증가하는 부분수열 또는 길이가 $K+1$인 감소하는 부분수열이 존재해야 하는데, 감소하는 부분수열의 최대 길이가 $K$이므로 길이가 $t+1$인 증가하는 부분수열이 존재합니다.</p>

<h2 id="관련-문제">관련 문제</h2>

<p><a href="/PS/boj-1201">1201 NMK</a></p>
:ET