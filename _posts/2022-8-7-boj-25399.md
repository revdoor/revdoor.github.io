---
layout: post
title: "[백준 25399] 라그랑주님 수학에는 뺄셈도 있어요 풀이"
categories: [PS]
use_math: true
tags: [math, number_theory, constructive]
---

## 문제 링크

[https://www.acmicpc.net/problem/25399](https://www.acmicpc.net/problem/25399)

## 문제 설명
정수 N이 주어졌을 때, 최소 개수의 서로 다른 양의 제곱수들의 합과 차로 표현하면 됩니다.

## 문제 풀이
#### 1. 음수일 경우?
음수의 경우, 부호를 바꾼 경우의 해답에서 모든 부호를 반전시키면 됩니다.
따라서, 양수의 경우만 생각합시다.

#### 2. 제곱수일 경우
특정 수가 제곱수인지는 기본적으로 이분탐색을 통해 확인할 수 있습니다.
제곱수일 경우 필요한 숫자는 당연히 1개입니다.
걸리는 시간은 $O(\log n)$입니다.

#### 3. 제곱수가 아닐 경우?
어... 이 경우는 어떻게 풀면 좋을까요?
경우가 너무 많이 갈라져서 접근하기 쉽지 않습니다.

여기서 뺄셈에 주목합니다.
뺄셈이 가능하다는 것이 가장 중요한 특징이라는 생각이 듭니다.

몇 가지 예시를 직접 만들어 보면서 확인해봅니다.
예를 들어, $8 = 3^2 - 1^2$이네요.
또는, $5 = 2^2 + 1^2 = 3^2 - 2^2$와 같은 예시도 있겠네요.
뺄셈에 집중하면서 어떤 형태의 수들을 표현 가능한지 살펴봅시다.

연속한 수들의 제곱수의 차가 어떻게 되는지 한번 살펴봅시다.
두 수를 $a, a+1$이라고 할 때, $(a+1)^2 - a^2 = 2a+1$입니다.
따라서, 모든 홀수를 해결할 수 있습니다.

연속한 두 짝수, 혹은 연속한 두 홀수의 제곱수의 차는 어떻게 될까요?
두 수를 $a-1, a+1$이라고 할 때, $(a+1)^2 - (a-1)^2 = 4a$가 나옵니다.
따라서, 모든 4의 배수를 해결할 수 있습니다.

즉, 남은 경우는 오직 2의 배수이나 4의 배수가 아닌 수들입니다.

#### 4. 2의 배수이나 4의 배수가 아닌 수 ($4k+2$ 꼴의 수)
$4k+2 = 4k+1 + 1 = 2 (2k) + 1 + 1^2$이므로, 홀수 표현을 통해 수 3개로는 표현이 가능할 것 같습니다.

그런데 수 2개로 표현 가능한 경우도 있습니다.
예를 들어, $10 = 3^2 + 1^2$이네요.

2개로 표현 가능한 경우만 다 찾아내면 될 것 같습니다.
제곱수를 4로 나눈 나머지는 0 또는 1이기 때문에, 2개로 $4k+2$ 꼴의 수를 표현하려면 홀수의 합만 가능합니다.

이 경우를 찾아주는 빠른 알고리즘이 존재하지만 수의 범위상 그정도까지는 필요하지 않은 것 같습니다.
모든 경우를 확인해보는 것으로 충분할 것으로 보입니다.

목표로 하는 수를 $N$이라고 합시다.
모든 홀수를 순서대로 $a_1, a_2, ...$라고 합시다.
이제, $N-a_1^2, N-a_2^2, ...$이 제곱수인지 각각 확인합니다.
제곱수일 경우, 같은 두 수의 합인지도 확인합니다.

$a_i$는 커봤자 $10^6-1$이기 때문에, 시간 안에 계산할 수 있습니다.
실제 걸리는 시간은 $10^6$까지의 홀수가 $k$개라고 할 때, $O(k \log n)$입니다.
따라서 시간 안에 해결할 수 있습니다.
